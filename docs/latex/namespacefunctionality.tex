\doxysection{functionality Namespace Reference}
\hypertarget{namespacefunctionality}{}\label{namespacefunctionality}\index{functionality@{functionality}}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacefunctionality_a484f43f22fe550fcdb76686f6ac78d3f}{generate\+\_\+rsa\+\_\+key}} ()
\begin{DoxyCompactList}\small\item\em Generate a 4096-\/bit RSA private key. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacefunctionality_ab63d69072dde1ba709216176432b12a2}{derive\+\_\+aes\+\_\+key}} (pin)
\begin{DoxyCompactList}\small\item\em Derive a 256-\/bit SHA key. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacefunctionality_a3d114e05619d61fc17864255f30a3621}{encrypt\+\_\+private\+\_\+key}} (private\+\_\+key, aes\+\_\+key)
\begin{DoxyCompactList}\small\item\em Encrypt private RSA key using AES key. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacefunctionality_a77df7485065ae857faa69528d747f953}{decrypt\+\_\+private\+\_\+key}} (encrypted\+\_\+data, aes\+\_\+key)
\begin{DoxyCompactList}\small\item\em Decrypt private RSA key using AES key. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacefunctionality_ae6531eefcaa9bb444d53f751e90ee51e}{create\+\_\+keys}} (pin, file\+\_\+path)
\begin{DoxyCompactList}\small\item\em Generate RSA key pair, derive AES key from PIN, encrypt the private key, and save both keys to files. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacefunctionality_ab69adcb8bcfa1e53173267c7d60361c8}{save\+\_\+public\+\_\+key}} (public\+\_\+key, output\+\_\+file)
\begin{DoxyCompactList}\small\item\em Save an RSA public key to a PEM-\/formatted file. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacefunctionality_a1de63ba33efd5250140b21a82111373e}{save\+\_\+encrypted\+\_\+private\+\_\+key}} (encrypted\+\_\+private\+\_\+key, output\+\_\+file)
\begin{DoxyCompactList}\small\item\em Save an AES-\/encrypted RSA private key to a binary file. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacefunctionality_adc94e58267a43d79d7070c92d48a858d}{prepare\+\_\+public\+\_\+key}} (file\+\_\+path)
\begin{DoxyCompactList}\small\item\em Reads public key from .pem file and returns it in DER encoding. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacefunctionality_ad9c228d18da80a90a4befdfd2a967315}{load\+\_\+and\+\_\+decrypt\+\_\+private\+\_\+key}} (file\+\_\+path, pin)
\begin{DoxyCompactList}\small\item\em Reads encrypted private key from .pem file and returns it in DER encoding. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacefunctionality_aee915e12008f5adbf00c3f4412691d07}{verify\+\_\+pdf}} (pdf\+\_\+file\+\_\+path, public\+\_\+key)
\begin{DoxyCompactList}\small\item\em Verify the digital signature of a signed PDF against a provided public key. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacefunctionality_a7a93ccc5c016802e6658f6c66377157e}{create\+\_\+cert}} (private\+\_\+key, save=False)
\begin{DoxyCompactList}\small\item\em Generate a self-\/signed X.\+509 certificate using the provided RSA private key. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacefunctionality_a1a519b61539d672fec01dd521eb369b5}{sign\+\_\+pdf}} (pdf\+\_\+file\+\_\+path, cert, key, change\+\_\+name=False)
\begin{DoxyCompactList}\small\item\em Digitally sign a PDF using an X.\+509 certificate and RSA private key. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacefunctionality_a4609c53e922d18210ffa848a3189724e}{verify\+\_\+is\+\_\+pdf\+\_\+signed}} (pdf\+\_\+file\+\_\+path)
\begin{DoxyCompactList}\small\item\em Check if chosen PDF is signed. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespacefunctionality_ad18951c3b5c0dd555a3e18bdf4fab929}{sign\+\_\+pdf\+\_\+full}} (pdf\+\_\+file\+\_\+path, key)
\begin{DoxyCompactList}\small\item\em Create a certificate and use it to sign a PDF. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacefunctionality_a510ff7ae6d0e44e0a7a6cd42205535c7}{level}}
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\Hypertarget{namespacefunctionality_a7a93ccc5c016802e6658f6c66377157e}\index{functionality@{functionality}!create\_cert@{create\_cert}}
\index{create\_cert@{create\_cert}!functionality@{functionality}}
\doxysubsubsection{\texorpdfstring{create\_cert()}{create\_cert()}}
{\footnotesize\ttfamily \label{namespacefunctionality_a7a93ccc5c016802e6658f6c66377157e} 
functionality.\+create\+\_\+cert (\begin{DoxyParamCaption}\item[{}]{private\+\_\+key}{, }\item[{}]{save}{ = {\ttfamily False}}\end{DoxyParamCaption})}



Generate a self-\/signed X.\+509 certificate using the provided RSA private key. 


\begin{DoxyParams}{Parameters}
{\em private\+\_\+key} & The private key to sign the certificate. \\
\hline
{\em save} & If True, saves the certificate to a file named \textquotesingle{}rsa\+\_\+cert.\+pem\textquotesingle{}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}


x509 A self-\/signed X.\+509 certificate.
\end{DoxyReturn}
\begin{DoxyParagraph}{Side Effects}

\begin{DoxyItemize}
\item Optionally writes the certificate to \textquotesingle{}rsa\+\_\+cert.\+pem\textquotesingle{}.
\item Logs debug messages including key types and certificate creation steps. 
\end{DoxyItemize}
\end{DoxyParagraph}
\Hypertarget{namespacefunctionality_ae6531eefcaa9bb444d53f751e90ee51e}\index{functionality@{functionality}!create\_keys@{create\_keys}}
\index{create\_keys@{create\_keys}!functionality@{functionality}}
\doxysubsubsection{\texorpdfstring{create\_keys()}{create\_keys()}}
{\footnotesize\ttfamily \label{namespacefunctionality_ae6531eefcaa9bb444d53f751e90ee51e} 
functionality.\+create\+\_\+keys (\begin{DoxyParamCaption}\item[{}]{pin}{, }\item[{}]{file\+\_\+path}{}\end{DoxyParamCaption})}



Generate RSA key pair, derive AES key from PIN, encrypt the private key, and save both keys to files. 


\begin{DoxyParams}{Parameters}
{\em pin} & User-\/provided PIN used to derive the AES key. \\
\hline
{\em file\+\_\+path} & Path where the encrypted private key will be saved (PEM format).\\
\hline
\end{DoxyParams}
\begin{DoxyParagraph}{Side Effects}

\begin{DoxyItemize}
\item Saves the encrypted private key to {\ttfamily file\+\_\+path}.
\item Saves the public key to {\ttfamily file\+\_\+path} with {\ttfamily \+\_\+pub.\+pem} suffix.
\item Logs debug messages about the operation.
\item Logs errors if key creation or file operations fail.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyReturn}{Returns}


None
\end{DoxyReturn}
\begin{DoxyVerb}   Logs exceptions internally but does not propagate them.
\end{DoxyVerb}
 \Hypertarget{namespacefunctionality_a77df7485065ae857faa69528d747f953}\index{functionality@{functionality}!decrypt\_private\_key@{decrypt\_private\_key}}
\index{decrypt\_private\_key@{decrypt\_private\_key}!functionality@{functionality}}
\doxysubsubsection{\texorpdfstring{decrypt\_private\_key()}{decrypt\_private\_key()}}
{\footnotesize\ttfamily \label{namespacefunctionality_a77df7485065ae857faa69528d747f953} 
functionality.\+decrypt\+\_\+private\+\_\+key (\begin{DoxyParamCaption}\item[{}]{encrypted\+\_\+data}{, }\item[{}]{aes\+\_\+key}{}\end{DoxyParamCaption})}



Decrypt private RSA key using AES key. 


\begin{DoxyParams}{Parameters}
{\em encrypted\+\_\+data} & byte string consisting of a 16-\/byte iv and AES-\/encrypted RSA key \\
\hline
{\em aes\+\_\+key} & The AES key (32 bytes) used for decryption.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}


rsa RSA private key object. 
\end{DoxyReturn}
\Hypertarget{namespacefunctionality_ab63d69072dde1ba709216176432b12a2}\index{functionality@{functionality}!derive\_aes\_key@{derive\_aes\_key}}
\index{derive\_aes\_key@{derive\_aes\_key}!functionality@{functionality}}
\doxysubsubsection{\texorpdfstring{derive\_aes\_key()}{derive\_aes\_key()}}
{\footnotesize\ttfamily \label{namespacefunctionality_ab63d69072dde1ba709216176432b12a2} 
functionality.\+derive\+\_\+aes\+\_\+key (\begin{DoxyParamCaption}\item[{}]{pin}{}\end{DoxyParamCaption})}



Derive a 256-\/bit SHA key. 


\begin{DoxyParams}{Parameters}
{\em pin} & User-\/provided pin.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}


bytes A 32-\/byte AES key derived from the SHA-\/256 hash of the pin. 
\end{DoxyReturn}
\Hypertarget{namespacefunctionality_a3d114e05619d61fc17864255f30a3621}\index{functionality@{functionality}!encrypt\_private\_key@{encrypt\_private\_key}}
\index{encrypt\_private\_key@{encrypt\_private\_key}!functionality@{functionality}}
\doxysubsubsection{\texorpdfstring{encrypt\_private\_key()}{encrypt\_private\_key()}}
{\footnotesize\ttfamily \label{namespacefunctionality_a3d114e05619d61fc17864255f30a3621} 
functionality.\+encrypt\+\_\+private\+\_\+key (\begin{DoxyParamCaption}\item[{}]{private\+\_\+key}{, }\item[{}]{aes\+\_\+key}{}\end{DoxyParamCaption})}



Encrypt private RSA key using AES key. 


\begin{DoxyParams}{Parameters}
{\em private\+\_\+key} & The RSA private key object to encrypt. \\
\hline
{\em aes\+\_\+key} & AES bytes.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}


bytes A byte string with initialization vector and encrypted RSA private key 
\end{DoxyReturn}
\Hypertarget{namespacefunctionality_a484f43f22fe550fcdb76686f6ac78d3f}\index{functionality@{functionality}!generate\_rsa\_key@{generate\_rsa\_key}}
\index{generate\_rsa\_key@{generate\_rsa\_key}!functionality@{functionality}}
\doxysubsubsection{\texorpdfstring{generate\_rsa\_key()}{generate\_rsa\_key()}}
{\footnotesize\ttfamily \label{namespacefunctionality_a484f43f22fe550fcdb76686f6ac78d3f} 
functionality.\+generate\+\_\+rsa\+\_\+key (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})}



Generate a 4096-\/bit RSA private key. 

Uses a public exponent of 65537 and the default cryptographic backend.

\begin{DoxyReturn}{Returns}


rsa A newly generated RSA private key object. 
\end{DoxyReturn}
\Hypertarget{namespacefunctionality_ad9c228d18da80a90a4befdfd2a967315}\index{functionality@{functionality}!load\_and\_decrypt\_private\_key@{load\_and\_decrypt\_private\_key}}
\index{load\_and\_decrypt\_private\_key@{load\_and\_decrypt\_private\_key}!functionality@{functionality}}
\doxysubsubsection{\texorpdfstring{load\_and\_decrypt\_private\_key()}{load\_and\_decrypt\_private\_key()}}
{\footnotesize\ttfamily \label{namespacefunctionality_ad9c228d18da80a90a4befdfd2a967315} 
functionality.\+load\+\_\+and\+\_\+decrypt\+\_\+private\+\_\+key (\begin{DoxyParamCaption}\item[{}]{file\+\_\+path}{, }\item[{}]{pin}{}\end{DoxyParamCaption})}



Reads encrypted private key from .pem file and returns it in DER encoding. 


\begin{DoxyParams}{Parameters}
{\em file\+\_\+path} & Path to the PEM-\/formatted public key file.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}


rsa RSA private key object.
\end{DoxyReturn}
\begin{DoxyParagraph}{Side Effects}

\begin{DoxyItemize}
\item Logs debug messages about the operation. 
\end{DoxyItemize}
\end{DoxyParagraph}
\Hypertarget{namespacefunctionality_adc94e58267a43d79d7070c92d48a858d}\index{functionality@{functionality}!prepare\_public\_key@{prepare\_public\_key}}
\index{prepare\_public\_key@{prepare\_public\_key}!functionality@{functionality}}
\doxysubsubsection{\texorpdfstring{prepare\_public\_key()}{prepare\_public\_key()}}
{\footnotesize\ttfamily \label{namespacefunctionality_adc94e58267a43d79d7070c92d48a858d} 
functionality.\+prepare\+\_\+public\+\_\+key (\begin{DoxyParamCaption}\item[{}]{file\+\_\+path}{}\end{DoxyParamCaption})}



Reads public key from .pem file and returns it in DER encoding. 


\begin{DoxyParams}{Parameters}
{\em file\+\_\+path} & Path to the PEM-\/formatted public key file.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}


bytes RSA public key bytes with DER encoding format.
\end{DoxyReturn}
\begin{DoxyParagraph}{Side Effects}

\begin{DoxyItemize}
\item Logs debug messages about the operation. 
\end{DoxyItemize}
\end{DoxyParagraph}
\Hypertarget{namespacefunctionality_a1de63ba33efd5250140b21a82111373e}\index{functionality@{functionality}!save\_encrypted\_private\_key@{save\_encrypted\_private\_key}}
\index{save\_encrypted\_private\_key@{save\_encrypted\_private\_key}!functionality@{functionality}}
\doxysubsubsection{\texorpdfstring{save\_encrypted\_private\_key()}{save\_encrypted\_private\_key()}}
{\footnotesize\ttfamily \label{namespacefunctionality_a1de63ba33efd5250140b21a82111373e} 
functionality.\+save\+\_\+encrypted\+\_\+private\+\_\+key (\begin{DoxyParamCaption}\item[{}]{encrypted\+\_\+private\+\_\+key}{, }\item[{}]{output\+\_\+file}{}\end{DoxyParamCaption})}



Save an AES-\/encrypted RSA private key to a binary file. 


\begin{DoxyParams}{Parameters}
{\em encrypted\+\_\+private\+\_\+key} & Encrypted private key data. \\
\hline
{\em output\+\_\+file} & Path to the output file.\\
\hline
\end{DoxyParams}
\begin{DoxyParagraph}{Side Effects}

\begin{DoxyItemize}
\item Writes the encrypted key to the file.
\item Logs the save operation.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyReturn}{Returns}


None 
\end{DoxyReturn}
\Hypertarget{namespacefunctionality_ab69adcb8bcfa1e53173267c7d60361c8}\index{functionality@{functionality}!save\_public\_key@{save\_public\_key}}
\index{save\_public\_key@{save\_public\_key}!functionality@{functionality}}
\doxysubsubsection{\texorpdfstring{save\_public\_key()}{save\_public\_key()}}
{\footnotesize\ttfamily \label{namespacefunctionality_ab69adcb8bcfa1e53173267c7d60361c8} 
functionality.\+save\+\_\+public\+\_\+key (\begin{DoxyParamCaption}\item[{}]{public\+\_\+key}{, }\item[{}]{output\+\_\+file}{}\end{DoxyParamCaption})}



Save an RSA public key to a PEM-\/formatted file. 


\begin{DoxyParams}{Parameters}
{\em public\+\_\+key} & The RSA public key to save. \\
\hline
{\em output\+\_\+file} & Path to the output file.\\
\hline
\end{DoxyParams}
\begin{DoxyParagraph}{Side Effects}

\begin{DoxyItemize}
\item Writes the public key in PEM format to the file.
\item Logs the save operation.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyReturn}{Returns}


None 
\end{DoxyReturn}
\Hypertarget{namespacefunctionality_a1a519b61539d672fec01dd521eb369b5}\index{functionality@{functionality}!sign\_pdf@{sign\_pdf}}
\index{sign\_pdf@{sign\_pdf}!functionality@{functionality}}
\doxysubsubsection{\texorpdfstring{sign\_pdf()}{sign\_pdf()}}
{\footnotesize\ttfamily \label{namespacefunctionality_a1a519b61539d672fec01dd521eb369b5} 
functionality.\+sign\+\_\+pdf (\begin{DoxyParamCaption}\item[{}]{pdf\+\_\+file\+\_\+path}{, }\item[{}]{cert}{, }\item[{}]{key}{, }\item[{}]{change\+\_\+name}{ = {\ttfamily False}}\end{DoxyParamCaption})}



Digitally sign a PDF using an X.\+509 certificate and RSA private key. 


\begin{DoxyParams}{Parameters}
{\em pdf\+\_\+file\+\_\+path} & Path to the PDF file to be signed. \\
\hline
{\em cert} & The X.\+509 certificate used for signing. \\
\hline
{\em key} & The RSA private key corresponding to the certificate. \\
\hline
{\em change\+\_\+name} & If True, output file will be named with \textquotesingle{}\+\_\+signed.\+pdf\textquotesingle{} suffix.\\
\hline
\end{DoxyParams}
\begin{DoxyParagraph}{Side Effects}

\begin{DoxyItemize}
\item Writes a new signed PDF file to disk (overwrites input if {\ttfamily change\+\_\+name} is False).
\item Logs and suppresses exceptions during signing.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyReturn}{Returns}


bool information if PDF was signed 
\end{DoxyReturn}
\Hypertarget{namespacefunctionality_ad18951c3b5c0dd555a3e18bdf4fab929}\index{functionality@{functionality}!sign\_pdf\_full@{sign\_pdf\_full}}
\index{sign\_pdf\_full@{sign\_pdf\_full}!functionality@{functionality}}
\doxysubsubsection{\texorpdfstring{sign\_pdf\_full()}{sign\_pdf\_full()}}
{\footnotesize\ttfamily \label{namespacefunctionality_ad18951c3b5c0dd555a3e18bdf4fab929} 
functionality.\+sign\+\_\+pdf\+\_\+full (\begin{DoxyParamCaption}\item[{}]{pdf\+\_\+file\+\_\+path}{, }\item[{}]{key}{}\end{DoxyParamCaption})}



Create a certificate and use it to sign a PDF. 

This function generates a self-\/signed certificate from the given RSA private key and uses it to apply a digital signature to the specified PDF file.


\begin{DoxyParams}{Parameters}
{\em pdf\+\_\+file\+\_\+path} & Path to the PDF file to be signed. \\
\hline
{\em key} & The RSA private key used for signing.\\
\hline
\end{DoxyParams}
\begin{DoxyParagraph}{Side Effects}

\begin{DoxyItemize}
\item Modifies the PDF file at {\ttfamily pdf\+\_\+file\+\_\+path} by adding a digital signature.
\item Logs errors with PDF 
\end{DoxyItemize}
\end{DoxyParagraph}
\Hypertarget{namespacefunctionality_a4609c53e922d18210ffa848a3189724e}\index{functionality@{functionality}!verify\_is\_pdf\_signed@{verify\_is\_pdf\_signed}}
\index{verify\_is\_pdf\_signed@{verify\_is\_pdf\_signed}!functionality@{functionality}}
\doxysubsubsection{\texorpdfstring{verify\_is\_pdf\_signed()}{verify\_is\_pdf\_signed()}}
{\footnotesize\ttfamily \label{namespacefunctionality_a4609c53e922d18210ffa848a3189724e} 
functionality.\+verify\+\_\+is\+\_\+pdf\+\_\+signed (\begin{DoxyParamCaption}\item[{}]{pdf\+\_\+file\+\_\+path}{}\end{DoxyParamCaption})}



Check if chosen PDF is signed. 


\begin{DoxyParams}{Parameters}
{\em pdf\+\_\+file\+\_\+path} & Path to the signed PDF file.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}


bool True if the PDF contains any signature. 
\end{DoxyReturn}
\Hypertarget{namespacefunctionality_aee915e12008f5adbf00c3f4412691d07}\index{functionality@{functionality}!verify\_pdf@{verify\_pdf}}
\index{verify\_pdf@{verify\_pdf}!functionality@{functionality}}
\doxysubsubsection{\texorpdfstring{verify\_pdf()}{verify\_pdf()}}
{\footnotesize\ttfamily \label{namespacefunctionality_aee915e12008f5adbf00c3f4412691d07} 
functionality.\+verify\+\_\+pdf (\begin{DoxyParamCaption}\item[{}]{pdf\+\_\+file\+\_\+path}{, }\item[{}]{public\+\_\+key}{}\end{DoxyParamCaption})}



Verify the digital signature of a signed PDF against a provided public key. 


\begin{DoxyParams}{Parameters}
{\em pdf\+\_\+file\+\_\+path} & Path to the signed PDF file. \\
\hline
{\em public\+\_\+key} & RSA public key to compare with the signer\textquotesingle{}s certificate.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}


bool True if the signature is cryptographically valid and matches the provided public key, False otherwise.
\end{DoxyReturn}
\begin{DoxyParagraph}{Side Effects}

\begin{DoxyItemize}
\item Logs debugging information about the verification process.
\item Reads and parses the PDF file.
\end{DoxyItemize}
\end{DoxyParagraph}
\begin{DoxyParagraph}{Notes}

\begin{DoxyItemize}
\item The function compares SHA-\/256 hashes of the provided public key to hash from the certificate.
\item Requires the PDF to have exactly one embedded signature. 
\end{DoxyItemize}
\end{DoxyParagraph}


\doxysubsection{Variable Documentation}
\Hypertarget{namespacefunctionality_a510ff7ae6d0e44e0a7a6cd42205535c7}\index{functionality@{functionality}!level@{level}}
\index{level@{level}!functionality@{functionality}}
\doxysubsubsection{\texorpdfstring{level}{level}}
{\footnotesize\ttfamily \label{namespacefunctionality_a510ff7ae6d0e44e0a7a6cd42205535c7} 
functionality.\+level}

